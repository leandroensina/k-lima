<html>
  <head>

  </head>

  <body>
    <input type="file" id="inputCSV" onchange="pegaCSV(this)">
    <div id="CSVsaida"></div>

    <script>
      var leitorDeCSV = new FileReader()
      window.onload = function init() {
        leitorDeCSV.onload = leCSV;
      }

      function pegaCSV(inputFile) {
        var file = inputFile.files[0];
        leitorDeCSV.readAsText(file);
      }

      /*
          Tendo um array de uma dimensao, a cconta para acessar a posicao da tabela se da por:
                                    17*L+C+L
          onde,
            L: Linha
            C: Coluna
            17: numero total de colunas (na verdade vai de 0 a 17)

          Colunas relevantes:
            10: Ano
            12: Descricao da Materia
            13: Total de Reprovados
            14: Total de Aprovados
            16: Porcentacem de Aprovados
            17: Porcentagem de Reprovados
      */
      function leCSV(evt){
        //fileArr sao as linhas do arquivo
        var fileArr = evt.target.result.split('\n');
        var strDiv = '<table>';

        var ano;
        var materia;
        var totalReprovados;
        var totalAprovados;
        var porcentagemAprovados;
        var porcentagemReprovados;

        var sheetsuUrl = "";

        for (var i = 0; i < fileArr.length; i++) {
          strDiv += '<tr>';
          var fileLine = fileArr[i].split(';');

          for (var j = 0; j < fileLine.length; j++) {
            if(j == 10){
                ano = fileLine[j].trim();
                strDiv += '<td>' + ano + '</td>';
              }

              if(j == 12){
                materia = fileLine[j].trim();
                strDiv += '<td>' + materia + '</td>';
              }

              if(j == 13){
                totalReprovados = fileLine[j].trim();
                strDiv += '<td>' + totalReprovados + '</td>';
              }

              if(j == 14){
                totalAprovados = fileLine[j].trim();
                strDiv += '<td>' + totalAprovados + '</td>';
              }

              if(j == 16){
                porcentagemAprovados = fileLine[j].trim();
                strDiv += '<td>' + porcentagemAprovados + '</td>';
              }

              if(j == 17){
                porcentagemReprovados = fileLine[j].trim();
                strDiv += '<td>' + porcentagemReprovados + '</td>';
              }

              var data = {

              };

              $.ajax({
                url: sheetsuUrl,
                data: data,
                dataType: 'json',
                type: 'PUT',

                // place for handling successful response
                // showing (redirecting to) something like /thanks.html
                // page could be a good idea
                success: function(data) {
                  console.log(data);
                },

                // handling error response
                error: function(data) {
                  console.log(data);
                }
              });
          }

          strDiv += '</tr>';
        }
        strDiv += '</table>';

        var CSVsaida = document.getElementById('CSVsaida');
        CSVsaida.innerHTML = strDiv;
      }

    </script>

  </body>

  <!-- http://tableless.com.br/file-api-trabalhando-com-arquivos-locais-usando-javascript/ -->

</html>
